---
title: Architecture
description: Deep dive into how DocX works under the hood.
order: 5
---

# Architecture

DocX is designed for performance, extensibility, and developer experience. It leverages the latest features of Next.js 16 (Turbopack) and React 19.

## Core Concepts

### 1. File-System Routing (Content Layer)
DocX doesn't use a database. It reads your `content/docs` directory at build time (and request time for dev) to generate routes.
- **Indexing**: `lib/search-index.ts` recursively walks folders to build a search index.
- **Navigation**: `lib/docs.ts` builds the sidebar hierarchy based on folder structure and `order` frontmatter.

### 2. Async I/O & Performance
We use Node.js `fs/promises` for all file operations.
- **Parallel Processing**: Metadata, navigation, and content loading often happen in parallel using `Promise.all`.
- **Caching**: Heavy operations like generating the sidebar structure are cached in memory or via React `cache()` to prevent redundant file reads.

### 3. Plugin System (The Interface Layer)
The UI is decoupled from the logic via the `x-meta.config.tsx`.
- **Dependency Injection**: Components like `DocSidebar` and `DocTOC` are injected via configuration.
- **Slot Pattern**: We use Render Props / React Nodes (`header`, `footer`) to allow consumers to inject content into layout components without forking them.

### 4. Search Abstraction
Search is defined by the `SearchProviderInterface`.
- **Local Provider**: The default implementation loads all docs into a client-side Fuse.js index.
- **Extensible**: You can implement the interface to connect to Algolia, Meilisearch, or Elasticsearch.

### 5. Headless Theming
We avoid CSS-in-JS runtime overhead.
- **CSS Variables**: Theme colors are injected as CSS variables into the `:root` or `.dark` scope via `ThemeInjector`.
- **Tailwind v4**: We use the latest Tailwind engine for instant HMR.

## Directory Structure

```text
├── app/                  # Next.js App Router
│   ├── api/              # Internal APIs for search/versions
│   └── docs/             # Documentation routes
├── content/              # Your MDX files
├── components/           # React UI components
├── lib/                  # Core logic (fs, parsing, plugins)
├── x-meta.config.tsx     # Main configuration
└── types/                # TypeScript definitions
```

## Data Flow

1. **Request**: User visits `/docs/v1/page`.
2. **Resolution**: `useContentData` hook validates the version and resolves the slug.
3. **Data Fetching**:
   - `generateNavigation` builds the sidebar.
   - `getDoc` parses MDX and frontmatter.
4. **Rendering**:
   - `SidebarSlot` and `TOCSlot` are retrieved from the registry.
   - Configuration styles are merged.
   - Header/Footer slots are instantiated.
   - Page renders with Server Side Rendering (SSR).
